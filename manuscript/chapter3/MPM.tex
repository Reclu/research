% \subsection{Historical review}
The early developments that led to the original MPM started with the \textbf{Particle-In-Cell} method (PIC) for fluid dynamics problems \cite{PIC}. The novelty brought by PIC was the representation of a fluid by a collection of moving particles inside a background control volume subdivided into cells. Every single particle is given a constant mass and a position which is updated based on the velocity field resulting from the solution of the discrete linear momentum balance equation on the fixed background mesh. On the other hand, velocity, energy and pressure are stored at cells centroids during the whole computation as element-wise constant fields ($C^0$ approximation). 
During the movement of Lagrangian points, fields are temporarily projected back and forth between the grid and particles so that the latters can advect information from one cell to another. This procedure is referred to as the \textit{convective phase}. PIC thus enables the merging of Lagrangian and Eulerian techniques since the moving particles with ascribed masses allow the simulation of problems involving several highly deformed fluids without mesh distortion.

In spite of the good results provided by PIC, the numerical diffusion it suffers from has been addressed by two different ways. First, the method has been extended to a \textit{fully Lagrangian} version \cite{McCrory_FLIP} by storing not only mass and position but all the fields at particles. Second, a new projection procedure from the grid to particles has been proposed in order to reach second-order accuracy in space of the convective phase \cite{PIC_Nishiguchi}. 
Rather than ascribing cells velocity to particles as what is done in PIC, Lagrangian points velocities are updated based on the change of linear momentum resulting from the solution of the discrete system. This approach enables the reduction of numerical diffusion but introduces noise in the vicinity of discontinuities \cite{Mass_Flip}.
Merging those two improvements yielded the so-called \textbf{FLuid Implicit Particle} method (FLIP) \cite{FLIP}. It is worth noticing that in this new PIC formulation, the background mesh is used for solving balance equations only , thus providing an adaptive feature to the numerical scheme. 


Even though particles carry the whole history of the problem, FLIP has been essentialy used until the 90's to model history-independent constitutive models which were dealt with at the grid level. The first application of the method to history-dependent materials was made in the context of solid mechanics \cite{Sulsky94}. Lagrangian particles are then seen seen as material points since they are used to store every fields of the problem and to compute constitutive equations, thus leading to the Material Point Method that is derived hereinafter. 

\subsection{Derivation of the MPM}
Consider a solid domain with volume $\Omega_t$ bounded by the surface $\partial \Omega_t$, subject to traction forces and prescribed velocity on its boundaries within the time interval $\tau=\[0,T\]$:
\begin{align}
  & \tens{\sigma}\cdot\vect{n}=\vect{T}_d \quad \text{on } \partial \Omega_t^\sigma\\
  & \vect{v} = \vect{\tilde{v}} \quad \text{on } \partial \Omega_t^v
\end{align}
where $\vect{n}$ is the outward normal vector to $\partial \Omega_t$ and the set of boundaries satisfies $\partial \Omega_t =\partial \Omega^\sigma_t \cap \partial \Omega^v_t$.
%We seek an approximate solution of the eulerian balance equation of linear momentum \eqref{eq:HPP_linear_momentum} in a finite-dimensional function space using Galerkin approach. 

\subsubsection*{Weak formulation of the continuum problem}
The weak form of the eulerian balance equation of linear momentum \eqref{eq:HPP_linear_momentum} is written based on the Galerkin approach and the following function spaces:
\begin{equation}
\Vscr^1 = \{ \vect{u} \in H^1(\Omega_t) \}  \quad ; \quad \Vscr^1_{h} = \{\vect{u} \in \Vscr^1 | \vect{u}=\vect{\tilde{v}} \text{ on } \partial \Omega_t^v \}  \quad ; \quad \Vscr^1_{h,0} = \{\vect{u} \in \Vscr_h^1 | \vect{u}=\vect{0} \text{ on } \partial \Omega_t^v \} 
\end{equation}
where $H^1(\Omega_t)$ denotes the \textit{Sobolev} space in $\Omega_t$ \cite[Ch.4]{Belytschko}, \cite[Ch.1]{DiPietro}. Multiplication of equation \eqref{eq:HPP_linear_momentum} by a test function $\vect{w} \in \Vscr^1_{h,0}$ and integration over $\Omega_t$ yields, after integration by parts, the following weak form:
\begin{equation}
  \label{eq:linear_momentum_weak_form}
  \begin{aligned}
    &\text{Find $\vect{v}\in \Vscr_h^1$ such that} \\
    &\int_{\Omega_t}  \rho  \vect{\dot{v}} \cdot \vect{w}\: dv + \int_{\Omega_t}\tens{\sigma}: 
    \nablat \vect{w} \:dv - \int_{\partial \Omega^\sigma_t} \vect{T}_d\cdot\vect{w}\: ds= \int_{\Omega_t} \rho \vect{b}\cdot \vect{w} \: dv  \qquad \forall \: \vect{w} \in \Vscr_{h,0}^1, \forall\: t \in \tau
  \end{aligned}
\end{equation}

\subsubsection{The MPM discretization}
The continuum body is discretized into a set of $N_p$ material points in an arbitrary Cartesian grid. The grid is here supposed to be made of $N_n$ nodes and $E$ non-overlapping cells or elements. The set of faces separating cells that contain particles and empty ones defines the boundary of the mesh (see figure \ref{fig:domain} for a two-dimensional case).
\begin{figure}[ht]
  \centering
  {\input{chapter3/pgfFigures/continuum}}
  {\input{chapter3/pgfFigures/mpm_discretization}}
  \caption{Representation of a continuum body by a set of material points in $\Rbb^2$.}
  \label{fig:domain}	
\end{figure}
Analogously to the Finite Element Method (FEM) \cite{Belytschko}, the velocity is approximated on the MPM background mesh by:
\begin{equation}
  \label{eq:approximation_basis}
  \vect{v}(\vect{x},t)=S_i(\vect{x})\vect{v}^{i}(t)
\end{equation}
where $\vect{v}^{i}$ is the velocity of the $i$th grid node, and $S_i(\vect{x})$ the (linear) shape function attached to it. One feature of the MPM is that the mass density is approximated in the grid based on the mass carried by each material point:
\begin{equation}
  \label{eq:density_approx}
  \rho\(\vect{x},t\)=\sum_{p=1}^{N_p} m_p \: \delta(\vect{\phi}(\vect{X}^p,t)-\vect{x})=\sum_{p=1}^{N_p} m_p \: \delta(\vect{x}^p-\vect{x})
\end{equation}
where the delta Dirac distribution $\delta$ is often referred to as the \textit{characteristic function} of material points, and $\vect{x}^p$ is the position of the $p$th particle. In what follows, the dependence on time will be omitted for simplicity and $p$ and $(i,j)$ stand respectively for material points and nodes. 

By introducing successively in the weak form \eqref{eq:linear_momentum_weak_form} the specific Cauchy tensor $\rho \tens{\bar{\sigma}}=\tens{\sigma}$ and the approximation of mass density \eqref{eq:density_approx}, the integration property of the delta Dirac distribution allows to write:
\begin{equation}
  \begin{aligned}
    &\text{Find $\vect{v}\in \Vscr_h^1$ such that} \\
    & \sum_{p=1}^{N_p} m_p  \[\vect{\dot{v}}(\vect{x}^p) \cdot \vect{w}(\vect{x}^p) + \tens{\bar{\sigma}}(\vect{x}^p):\nablat \vect{w}(\vect{x}^p) \]  = \sum_{p=1}^{N_p}m_p \vect{b}(\vect{x}^p)\cdot \vect{w}(\vect{x}^p) + \int_{\partial \Omega^\sigma_t} \vect{T}^d\cdot\vect{w}\: ds  \qquad \forall \: \vect{w} \in \Vscr_{h,0}^1, \forall\: t \in \tau
  \end{aligned}
\end{equation}
Then, with the finite element approximation \eqref{eq:approximation_basis}, the weak form reads:
\begin{equation}
  \label{eq:mpm_discrete_weak}
    \begin{aligned}
      &\text{Find $\vect{v} \in \Vscr_h^1$ such that} \\
      & \vect{w}^j \sum_{p=1}^{N_p} m_p  \[ S_{jp} S_{ip} \vect{\dot{v}}^i + \nablav S_{jp} \cdot \tens{\bar{\sigma}}^p \]  =  \vect{w}^j\( \sum_{p=1}^{N_p}m_p S_{jp}\vect{b}^p  + \int_{\partial \Omega^\sigma_t} S_j(\vect{x})\vect{T}^d\: ds\)  \qquad \forall \: \vect{w} \in \Vscr_{h,0}^1, \forall \: t \in \tau
  \end{aligned}
\end{equation}
in which $S_{ip}=S_i(\vect{x}^p)$ and $\tens{\bar{\sigma}}^p=\tens{\bar{\sigma}}(\vect{x}^p)$. Next, the arbitrariness of the test function $\vect{w}$ leads to the semi-discrete equation in matrix form:
\begin{equation}
  \label{eq:mpm_semi-discrete}
  M_{ji} \vect{\dot{v}}^i = \vect{f}_{int}^j + \vect{f}_{ext}^j 
\end{equation}
where the definition of the mass matrix $M_{ij}$ and internal and external force vectors $\vect{f}_{int}^j $ and $\vect{f}_{ext}^j$ are:
\begin{subequations}
  \begin{alignat}{1}
    & M_{ij}= \sum_{p=1}^{N_p} m_p  S_{jp} S_{ip} \label{eq:mass_matrix}\\
    & \vect{f}_{int}^j = - \sum_{p=1}^{N_p} m_p \nablav S_{jp} \cdot \tens{\bar{\sigma}}^p \label{eq:int_forces}\\
    & \vect{f}_{ext}^j =\sum_{p=1}^{N_p}m_p S_{jp}\vect{b}^p  + \int_{\partial \Omega^\sigma_t} S_j(\vect{x})\vect{T}^d\: ds \label{eq:ext_forces}
  \end{alignat}
\end{subequations}
In addition, note that particles play the role of integration points in the semi-discret form so that the mass matrix depends on the positions of material points in the grid and must be computed at each time step. Hence, the MPM can be seen as an extension of FEM with moving Gauss points. However, this quadrature rule results in a consistent mass matrix $M_{ji}$ that may be singular when only one material point lies in an element due to reduced integration. The use of a linear combination of the (positive-definite) diagonally lumped mass matrix $M^L_i=\sum_p S_{ip}m_p$, and the (positive semi-definite) constitent mass matrix is then recommended \cite{Love}. Nevertheless, since no parameter values are prescribed for this combination, the lumped mass matrix is widely used in MPM simulations in spite of additional dissipation of kinetic energy it introduces \cite{Mass_Flip}. 

At last, system \eqref{eq:mpm_semi-discrete} is solved for nodal accelerations $\vect{\dot{v}}^i$, which time integration allows to update nodal velocities. Hence, the time interval $\tau$ is discretized in $N_T$ sub-intervals of size $\Delta t^n$ such that $\sum_{n=1}^{N_T} \Delta t^n = T$ and time integration is performed with an explicit forward Euler algorithm. The discrete equations are thus written:
\begin{equation}
  \label{eq:mpm_discrete}
  \frac{\vect{v}^{i,n+1}-\vect{v}^{i,n}}{\Delta t^n} = \vect{\dot{v}}^i
\end{equation}
where the superscripts $\bullet^{k,l}$ denote the time step $l$ at which the $k$th nodal field is evaluated. 

Recall that the background grid inherited from FLIP is arbitrary so that fields must be projected between particles and nodes to $(i)$ solve the linear system \eqref{eq:mpm_discrete} and $(ii)$ advect the solution by moving material points. The first mapping step, required to build the discrete form, aims at satisfy the conservation of linear momentum:
\begin{equation}
  \label{eq:particles2nodes}
  M^{L,n}_i \vect{v}^{i,n} = \sum_{p=1}^{N_p} S_{ip}m_p \vect{v}^{p,n}
\end{equation}
that must be solved for every $\vect{v}^i$. Once the nodal accelerations are calculated from system \eqref{eq:mpm_semi-discrete}, the velocity of each material points is \textbf{updated} according to the approach followed in FLIP \cite{PIC_Nishiguchi}:
\begin{equation}
  \label{eq:mp_velocity_update}
  \vect{v}^{p,n+1}= \vect{v}^{p,n}+ \Delta t^n \sum_{i=1}^{N_n} S_{ip}\vect{\dot{v}}^{i}
\end{equation}
On the other hand, updated nodal velocities resulting from the solution of \eqref{eq:mpm_discrete} are used to update the particles positions:
\begin{equation}
  \label{eq:position_update}
  \vect{x}^{p,n+1}=\vect{x}^{p,n} + \Delta t^n\sum_{i=1}^{N_n} S_{ip}\vect{v}^{i,n+1} 
\end{equation}

\begin{remark}
  \label{rq:dual_velo}
  Equations \eqref{eq:mp_velocity_update} and \eqref{eq:position_update} lead to a double definition of the velocity since the time derivative of the displacement of a given particle does not correspond to its velocity. This can be seen in a finite differences sense by combining equations \eqref{eq:mpm_discrete}, \eqref{eq:position_update}:
  \begin{equation}
    \frac{\vect{x}^{p,n+1} - \vect{x}^{p,n}}{\Delta t^n}  =\sum_{i=1}^{N_n} S_{ip}\vect{v}^{i,n+1} = \sum_{i=1}^{N_n} S_{ip} \( \vect{v}^{i,n} + \Delta t \vect{\dot{v}}^i\)
  \end{equation}
  and subsequently \eqref{eq:mp_velocity_update}:
  \begin{equation}
    \frac{\vect{x}^{p,n+1} - \vect{x}^{p,n}}{\Delta t^n}= \sum_{i=1}^{N_n} S_{ip} \vect{v}^{i,n} +   \vect{v}^{p,n+1} - \vect{v}^{p,n}
  \end{equation}
  Considering the mapping \eqref{eq:particles2nodes}, the right-hand side of this equation does not identify to the updated material point velocity, it then comes out that $\vect{\dot{x}}^{p,n+1} \ne \vect{v}^{p,n+1}$. 
\end{remark}

The computation of constitutive equations is performed at material points within the MPM, thanks to the updated nodal velocity field and the gradient of shape functions. One has therefore some freedom since stress can be updated right after either the resolution of \eqref{eq:mpm_discrete} or the projection \eqref{eq:particles2nodes}. The first option yields the \textit{Update Stress Last} (USL) algorithm while the second implementation is called \textit{Update Stress First} (USF) \cite{Bardenhagen_USF_USL}. 

\subsubsection{Boundary conditions enforcement}

Writing the weak form of linear momentum balance on the grid implies that Neumann boundary conditions are enforced on nodes throught the external force vector \eqref{eq:ext_forces}. Next, since stress are computed at material points based the nodal velocity field, Dirichlet boundary conditions are also dealt with at nodes. For USL, it is done once the solution is updated on the grid so that stresses can be computed and material points kinematic can be updated. On the other hand, USF formulation  first requires applying Dirichlet boundary conditions to compute the stress, and then again after solving discrete equations for particles kinematic \cite{USF_USL}. Furthermore, the enforcement of boundary condition is still a challenging aspect of the material point method (as others mesh-free methods) for problems involving complex geometries, see for instance \cite{Bcs_MPM}.

\subsubsection{Solution scheme summary}
All the ingredients derived above are now summarized to write the procedure followed within the MPM for one time step. Position and velocity vectors $\vect{x}^n$ and $\vect{v}^n$ are supposed known at every material points that discretize the continuum body in a computational grid at time $t^n$. USL formulation further requires the knowledge of the specific stress tensor $\tens{\bar{\sigma}}^n$ at material points. The MPM solution scheme then consists of the following steps:
\begin{itemize}
\item[(a)] Computation of the consistent and lumped mass matrices as well as external forces (Neumann boundary conditions) from equations \eqref{eq:mass_matrix} and \eqref{eq:ext_forces}.
\item[(b)] Projection of fields to the grid \eqref{eq:particles2nodes} and enforce Dirichlet boundary conditions on the nodal velocity. 
$\newline$
\textbf{USF formulation:} enforcement of Dirichlet boundary conditions on the mesh and integration of constitutive equations.
\item[(c)] Evaluation of internal forces from equation \eqref{eq:int_forces}.
\item[(d)] Solution of the semi-discrete and discrete forms \eqref{eq:mpm_semi-discrete} and \eqref{eq:mpm_discrete} so that nodal accelerations $\vect{\dot{v}}^i$ and updated velocities $\vect{v}^{i,n+1}$ are determined. Enforcement of Dirichlet boundary conditions.%: set the velocity of boundary nodes to the prescribed values and their accelerations to zero.
\item[(e)] Update material points velocities and positions with equations \eqref{eq:mp_velocity_update} and \eqref{eq:position_update} respectively. At this point the mesh has virtually moved, but since fields have been transferred back to particles, the underlying grid can be discarded and rebuilt for computational convenience, thus involving the projection (b) at the subsequent time increment. 
$\newline$
\textbf{USL formulation:} compuation of constitutive equations.
%\item[(f)] If the USL implementation is set, constitutive equations must be integrated.
\end{itemize}

Although the material point method presented above has been successfully applied to a wide range of complex engineering problems involving finite deformations \cite{Wieckowski}, this approach suffers from limitations which are discussed in the next section. 

\subsection{Shortcomings of the MPM}

\subsubsection*{The grid-crossing instability}
The research on MPM mainly focused so far on the instability arising from the computation of internal forces when material points move from one cell to another, the so-called \textit{grid-crossing} error \cite{Gimp}. In that case, the discontinuity of shape functions gradients across element interfaces yields tremendous noise in the numerical solution. The \textbf{Generalized Interpolation Material Point Method} (GIMP) addressed this issue by modifying the particles characteristic function, thus widening the domain of influence of material points \cite{Gimp}. By doing so, every particles are given a domain having a constant shape or not, that must be tracked during the computation, leading respectively to the uniform GIMP (uGIMP) or contiguous particle GIMP (cpGIMP) formulations \cite{Book_MPM}. In the cpGimp algorithm, diagonal entries of the deformation gradient are used to update the "shapes" of particles. The \textbf{Convected Particle Domain Interpolation} (CPDI) \cite{CPDI}, on the other hand, accounts for shear deformations and rotations of particles domains, thus providing an improvement of GIMP. However, those methods involve other difficulties related to the tracking of the deforming domains of material points in the Eulerian grid, and may also suffer from mesh entanglement \cite{DDMPM0}. Other approaches consisting in the direct modification of the approximation basis have been then followed to tackle the grid-crossing error. First, the \textbf{B-Spline Material Point Method} (BSMPM) \cite{Steffen_quadError} uses quadratic or cubic B-Spline functions with continuous gradients as nodal shape functions allowing to circumvent the instability \cite{MPM_BSpline1}. % (which can be seen as an IsoGeometric Analysis IGA \cite{IGA_Hughes} for immersed boundary problems, notion of unification ? c'est plus pour du fluide structure cette terminologie)
Second, the classical approximation basis is used and modified gradients with extended supports are introduced in the \textbf{Dual Domain Material Point Method} (DDMPM) \cite{DDMPM0}. BSMPM and DDMPM  both solve the grid-crossing error by widening the domain of influence of material points since B-Spline functions span more cells than Lagrange polynomials, and the support of the modified gradient of DDMPM is larger than that of the shape functions.  

\subsubsection*{The back-mapping instability}
Numerical oscillations appear in the MPM solution even for problems that do not involve the grid-crossing instability, that is due to the updating of the velocity field at material points \cite{Mass_Flip}. As an illustration, consider a one-dimensional elastic bar of length $L=6\:m$ with Young's modulus $E=200 \:GPa$ and mass density $\rho=7800 \:kg\cdot m^{-3}$ within the infinitesimal theory. The bar is initially in a free stress state and Riemann-type initial velocities are prescribed along the bar, that is: $v=v_0>0$ for $x\in[0,L/2]$ and $v=-v_0$ for $x \in [L/2,L]$.
\begin{figure}[ht]
  \centering
  {\input{chapter3/pgfFigures/US_diffusion10} \phantomsubcaption \label{subfig:US_diffusion_10}}
  {\input{chapter3/pgfFigures/US_diffusion25} \phantomsubcaption \label{subfig:US_diffusion_25}}\\
  {\input{chapter3/pgfFigures/US_energies} \phantomsubcaption \label{subfig:US_energies}}
  \caption{MPM solutions of the bars impact problem for various discretizations. (a)--(b) comparison of stress computed with USF and USL formulations and exact solutions (c) numerical total energy evolutions. Parameters: $CFL=0.7$ ; $v_0=\frac{1}{200}\sqrt{\frac{E}{\rho}}$.}
  \label{fig:US_diffusion}
\end{figure}
Both ends of the bar are traction free so that this problem is equivalent to an impact of two elastic bars moving toward each other. The bar is discretized by using the MPM in a computational grid composed of $50$ regular cells, each containing either one or two material points (1ppc or 2ppc). Single material points are centered in cells while "cellmate" particles are placed symmetrically with respect to elements centers and are regularly spaced. The exact solution of this problem (see section \ref{subsec:charac_Linear_problems}) consists of two elastic discontinuities emanating from the middle of the bar and propagating left and rightward. In figure \ref{fig:US_diffusion}, numerical results provided by the USL and USF implementations of the MPM are compared to the exact solution before reflection of the waves on the boundaries. 

Figures \ref{fig:US_diffusion}\subref{subfig:US_diffusion_10} and \ref{fig:US_diffusion}\subref{subfig:US_diffusion_25} show that both USL and USF solutions oscillate once the elastic front passed. Those oscillations are much more significant in the USF solutions regardless of the number of particles used. Indeed, the noise in USL results quickly reduces so that the correct stress level is reached in the middle region of the bar. Moreover, even though the $1ppc$ and $2ppc$ discretizations provide different results (slightly different for USL), neither of them enables the removal of oscillations. Figure \ref{fig:US_diffusion}\subref{subfig:US_energies} shows, on the other hand, the evolution of numerical total energies resulting from an MPM approximation of kinetic and strain energies:
\begin{align}
  & e^{kin}=\frac{1}{2}\int_\Omega \rho \vect{v}\cdot\vect{v} \:d\Omega \approx \frac{1}{2}\sum_{p=1}^{N_p} m_p \vect{v}^p\cdot\vect{v}^p\\
& e^{strain}= \frac{1}{2}\int_\Omega \rho \tens{\bar{\sigma}}: \nablav \vect{v} \:d\Omega \approx \frac{1}{2}\sum_{p=1}^{N_p} m_p \tens{\bar{\sigma}}^p: \nablav \vect{v}^p
\end{align}
One can see that the USL formulation is more diffusive than the USF for this problem. These results differ from observations made in \cite{Bardenhagen_USF_USL} in which no significant differences for problems involving smooth solutions is noticed. At last, figure \ref{fig:US_velocities} shows the numerical velocities at several time steps. The same observations than before are made by looking at figures \ref{fig:US_velocities}\subref{subfig:US_velo_10} and \ref{fig:US_velocities}\subref{subfig:US_velo_25}, namely numerical oscillations in both USL and USF solutions with bigger picks in USF one. Nevertheless, a notable numerical artifact that prevents the proper assessment of the velocity occurs at the middle of the bar when two particles per cell are used. This can be partially explained by the oscillating stress field that introduce noise in internal forces as well. However, the velocity field given by USL computation "locks" in the central region although the stress field converges in time to the exact solution (figures \ref{fig:US_diffusion}\subref{subfig:US_diffusion_10} and \ref{fig:US_diffusion}\subref{subfig:US_diffusion_25}), which implies that this issue is not due to the computation of internal forces, but most likely to the convective phase.
\begin{figure}[ht]
  \centering
  {\input{chapter3/pgfFigures/US_velo10}\phantomsubcaption \label{subfig:US_velo_10}}
  {\input{chapter3/pgfFigures/US_velo25}\phantomsubcaption \label{subfig:US_velo_25}}
  \caption{Comparison between exact, USF and USL velocities of the bars impact problem for various discretizations.}
  \label{fig:US_velocities}
\end{figure}

Since the the back-mapping is known to be responsible for noise introduced in MPM solution \cite{Mass_Flip}, we propose to project the velocity onto particles by a simple interpolation, as it is done in PIC:
%Since the the back-mapping of fields from the grid to material points is known to be responsible for noise introduced in MPM solution , we propose to project fields onto particles as it is done in PIC instead, that is by a simple interpolation:
\begin{equation}
  \label{eq:PIC_Back-mapping}
  \vect{v}^{p,n+1}=\sum_{i=1}^{N_n} S_{ip}\vect{v}^{i,n+1}
\end{equation}
Particles positions are next updated as in FLIP, with the nodal velocity \eqref{eq:position_update}, thus amouting to deform Lagrangian particles with the grid and exactly satisfy the relation $\vect{\dot{x}}^p=\vect{v}^p$, which is not the case in MPM. It is then worth noticing that the weak form \eqref{eq:mpm_discrete_weak} is based on the definition \eqref{eq:PIC_Back-mapping}, this projection seems therefore more consistent.

The comparison between MPM using either PIC or FLIP mapping and exact velocities is plotted in figures \ref{fig:MPM_velocities}\subref{subfig:MPM_velo_10} and \ref{fig:MPM_velocities}\subref{subfig:MPM_velo_25}
\begin{figure}[h!]
  \centering
  {\input{chapter3/pgfFigures/mpm_velo10}\phantomsubcaption \label{subfig:MPM_velo_10}}
  {\input{chapter3/pgfFigures/mpm_velo25}\phantomsubcaption \label{subfig:MPM_velo_25}}
  \caption{Comparison between USL algorithm with classical or PIC mapping and exact velocities of the bars impact problem for various discretizations.}
  \label{fig:MPM_velocities}
\end{figure}
\begin{figure}[h!]
  \centering
  {\input{chapter3/pgfFigures/mpm_diffusion10} \phantomsubcaption \label{subfig:mpm_diffusion_10}}
  {\input{chapter3/pgfFigures/mpm_diffusion25} \phantomsubcaption \label{subfig:mpm_diffusion_25}}
  {\input{chapter3/pgfFigures/mpm_energies} \phantomsubcaption \label{subfig:mpm_energies}}
  \caption{Comparison of USL solutions using either PIC or FLIP projection and exact solution of the bars impact problem for various discretizations. (a)--(b) comparison of stress profiles at several time steps (c) evolution of total energy. Parameters: $CFL=0.7$ ; $v_0=\frac{1}{200}\sqrt{\frac{E}{\rho}}$.}
  \label{fig:mpm_diffusion}
\end{figure}
As can be seen, PIC projection eliminates the noise in numerical solutions as well as the velocity locking in the central region of the bar. In addition, stress results provided by the USL using PIC mapping are also close to the exact solution (see figures \ref{fig:mpm_diffusion}\subref{subfig:mpm_diffusion_10} and \ref{fig:mpm_diffusion}\subref{subfig:mpm_diffusion_25}). However, the resolution of discontinuities allowed by the "modified" USL--MPM is slightly lower than that of the original formulation owing to numerical diffusion as shown in the energy plot in figure \ref{fig:mpm_diffusion}\subref{subfig:mpm_energies}. This result was expected since the FLIP projection was preferred to PIC one for it enabled a reduction of numerical dissipation \cite{PIC_Nishiguchi}.

% This balance between diffusion and noise resulting from the projection between nodes and particles selected has been emphasized in \cite{XPIC}
% Furthermore, the mapping \eqref{eq:PIC_Back-mapping} has been identified in \cite{XPIC} as a solution of the problem:
% \begin{equation}
%   \vect{v}^{p,n+1} = \arg \min_{\vect{v}^{p}}|| \vect{v}^{p}||_2,\quad \text{such that }  \frac{\sum_{p=1}^{N_p}S_{ip} m_p\vect{v}^{p}}{\sum_{k=1}^{N_p}S_{ik} m_k}=\vect{v}^{i,n+1}
% \end{equation}
% in which the minimization is achieved by dissipating kinetic energy.
 
\subsection{Strategy for reducing oscillations and diffusion}
We are concerned here with the accurate solution of hyperbolic problems in solid undergoing finite deformations. Although the MPM enables an efficient management of large strains, the oscillations it suffers from do not allow to accurately capture waves propagating in a medium. The above numerical simulations however suggest that noise can be removed by using an interpolation instead of an update of material points velocity, at the cost of additional diffusion. Thus, the use of  a linear combination of PIC and FLIP projections to update particles velocity was proposed in \cite{Nairn}, which can be seen as an artificial damping. Further, a tunable mapping procedure based on a parameter $m$ that completely eliminates noise in MPM solution has been proposed in the \textit{Extended PIC of order m (XPIC(m))} \cite{XPIC}. A classical interpolation is selected for $m=1$ whereas the mapping tends to FLIP one as $m \rightarrow \infty$ while avoiding oscillations in dissipating energy. Therefore, the method is still unable to capture discontinuities.

The point of view adopted in this thesis is that numerical diffusion is essentially due to the projection of fields from nodes to particles which spreads the information. Hence, a reduction of the domain of influence of nodes might result in lower dissipation. As a consequence, the reintroduction of PIC mapping combined to the \textit{Discontinuous Galerkin} approximation (DG) within the MPM is proposed here. These two features are expected to respectively avoid spurious oscillations and numerical diffusion.


%%% Local Variables: 
%%% mode: latex
%%% TeX-master: "../mainManuscript"
%%% End:
