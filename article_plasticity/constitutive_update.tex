
%The variational reformulation of the constitutive equations derived in section \ref{subsec:cont_constitutive} is carried out by introducing the following power density function \cite{Laurent2010}:
%The variational formulation of the constitutive relations derived in section \ref{subsec:cont_constitutive} follows from the minimization of the power density function \cite{Laurent99,Laurent2010}:
% Let's introduce the following power density function \cite{Laurent2010}:
The constitutive equations derived in section  \ref{subsec:cont_constitutive}, which account for the dependence of the material on the loading history, are usually integrated within an incremental procedure by means of radial return algorithms \cite{Simo}. 
Alternatively, the set of equations can be formulated as an optimization problem by introducing some power density function \cite{Laurent99,Laurent2010}:
\begin{equation}
  \label{eq:rate_potential}
  \Pscr(\tens{\dot{F}},\dot{p}) = \drond{\psi}{\tens{F}}:\tens{\dot{F}} - Y\dot{p} + \phi^*(\dot{p})
\end{equation}
whose minimizations with respect to $\dot{p}$ and $\tens{M}$ respectively lead to:
\begin{equation}
  \label{eq:optimization}
  -Y + \drond{\phi^*}{\dot{p}} = 0  \quad ;\quad \underset{\tens{M}}{\max} \left\lbrace \tens{T}\(\tens{M}\tens{F}^p\) \cdot \dot{p}\right\rbrace
\end{equation}
The first equation is the dual form of the kinetic equations \eqref{eq:dual_form_kinetic} while the second one yields the determination of the plastic flow direction by satisfying the principle of maximum plastic dissipation.
Moreover, it can  be shown that the effective power density $\Pscr^{eff}(\tens{\dot{F}})= \underset{\dot{p},\tens{M}}{\min} \: \Pscr$
% \begin{equation}
%   \label{eq:effective_power_density}
%   \Pscr^{eff}(\tens{\dot{F}})= \underset{\dot{p},\tens{M}}{\min} \: \Pscr
% \end{equation}
acts as a rate potential for $\tens{\Pi}$, that is:
\begin{equation}
  \label{eq:PK1_rate_potential}
  \tens{\Pi}=\drond{\Pscr^{eff}}{\tens{\dot{F}}}
\end{equation}

Variational constitutive updates can be constructed upon approximations of $\Pscr^{eff}$ by introducing the incremental energy function:
\begin{equation}
  \label{eq:incremental_energy}
  W(\tens{F}_{n+1};\tens{F}_n,p_n) = \underset{p_{n+1},\tens{M}}{\min} \:\left\lbrace \psi\(\tens{F}_{n+1},\tens{F}^p_{n+1},p_{n+1}\) -\psi\(\tens{F}_{n},\tens{F}^p_{n},p_{n}\) + \Delta t \left\langle \phi^*\(\dot{p}_{n}\)\right\rangle\right\rbrace
\end{equation}
In equation \eqref{eq:incremental_energy}, it is understood that the subscripts refer to time increments and that the thermodynamic state $(\tens{F}_n,\tens{F}^p_n,p_n)$, as well as the updated deformation gradient $\tens{F}_{n+1}$, are known.
Moreover, $\left\langle \bullet \right\rangle$ stands for a suitable incremental approximation of the rate of internal variables $\dot{p}$.
Thus, the plastic part of the deformation gradient results from the incremental plastic flow rule: 
\begin{equation}
  \label{eq:flow_rule_inc}
  \tens{F}^p_{n+1}=\exp \(\Delta p \tens{M} \)\tens{F}^p_n
\end{equation}
in which $\Delta p = p_{n+1}-p_n$, and $\tens{M}$ and $p_{n+1}$ are the argument of the optimization \eqref{eq:incremental_energy}.
At last, the updated first Piola-Kirchhoff stress tensor is:
\begin{equation}
  \label{eq:PK1_inc}
  % \tens{\Pi}_{n+1} = \left.\drond{\psi}{\tens{F}}\right|_{t_{n+1}}=\drond{W(\tens{F}_{n+1})}{\tens{F}_{n+1}}
  \tens{\Pi}_{n+1} = \left.\drond{\psi}{\tens{F}}\right|_{t_{n+1}}=\drond{W}{\tens{F}_{n+1}}
\end{equation}
so that $W$ appears as a potential for $\tens{\Pi}_{n+1}$.
In addition, incremental tangent moduli corresponding to the variational update follow from the linearization of the above equation:
\begin{equation}
  \label{eq:tangent_modulus}
  \Hbb_{n+1}=\drond{\tens{\Pi}_{n+1}}{\tens{F}_{n+1}}= \left.\ddrond{W}{\tens{F}}{\tens{F}}\right|_{t_{n+1}} + \left.\ddrond{W}{\tens{F}}{p}\drond{p}{\tens{F}} \right|_{t_{n+1}}
\end{equation}
Recall that a purely hyperelastic approximate Riemann solver is used, in such a way that only the first term of the right hand side in equation \eqref{eq:tangent_modulus} is taken into account for the computation of intercell fluxes.
\review{Talk about
  \begin{itemize}
  \item particularization to Hencky potential, give expressions of potentials. In that case it is equivalent to a return mapping
  \item interesting for thermomecanical problems. Even in the case on isothermal elastoplasticity, it allows for genericity (can be extended to viscoplasticity without requiring the solution of a RHS), similar to hyperelasticity. 
  \end{itemize}
}



%%% Local Variables:
%%% mode: latex
%%% TeX-master: "manuscript"
%%% End:
